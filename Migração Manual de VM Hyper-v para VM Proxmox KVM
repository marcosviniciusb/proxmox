<<<Passo a passo para conversão dos vHDs Hyper-v para Proxmox KVM (Discos raw e qcow2)>>>

Obs: Efetuar modificações dos vHDs sempre salvando o convertido no MESMO STORAGE. ***Fazer um por vez***. NÃO RECORTAR. SEMPRE UTILIZAR FERRAMENTAS DE CÓPIA COMO cp, rsync, pv e etc.

Efetuar backup completo de cada VM utilizando a ferramenta nativa do Hyper-v e guardar para possível emergência

Restaurar backup das VMs originais através da VM WinX.
  
Copiar os arquivos destas VMs para o Storage temporário de backup via rsync.
Conferir se o tamanho de cada vHD é exatamente idêntico ao arquivo do local anterior (considerar kbytes e bytes) e checar pelo md5sum

Copiar estes arquivos do Storage bkp para o novo Hypervisor (Dedicado) via rsync.
Conferir se o tamanho de cada vHD é exatamente idêntico ao arquivo do local anterior (considerar kbytes e bytes) e checar pelo md5sum
  
Criar VM Geração 2 para cada vHD, inicialize e verifique se está ok (Deixe cada VM original criada no Hyper-v)
  
Vamos precisar converter as instalações windows de UEFI/GPT para BIOS Tradicional.
Para isso, crie uma VM winX (usei win8.1) para utilizar um programa que fará esta conversão.

Anexe cada vHD nesta VM windows que será utilizada para conversão dos vHDs.
  
Conferir se o tamanho de cada vHD é exatamente idêntico ao arquivo do local anterior (considerar kbytes e bytes) e checar no windows por método semelhante ao md5sum do linux
  
Converter modo de boot de GPT para BIOS e excluir partições adicionais.
  
Copiar drivers Virtio para unidade raíz de cada VM (vHD).
  
Criar uma VM para cada vHD de SO das VM originais e anexar a elas seus vHDs.
  
Aplicar correção p/ boot modo BIOS em cada vHD. https://4sysops.com/?p=23775
  
Instalar drivers Virtio
  
Aplicar Sysprep (generalize/shutdown)
  
Copiar cada vHD modificado de volta ao Storage
  
Conferir se o tamanho de cada vHD é exatamente idêntico ao arquivo do local anterior (considerar kbytes e bytes) e checar pelo md5sum
  
No Hypervisor Linux, copie via 'rsync' os vHDs alterados para uma única unidade.
  
Conferir se o tamanho de cada vHD é exatamente idêntico ao arquivo do local anterior (considerar kbytes e bytes) e checar pelo md5sum
  
Converter vHDs de SO para 'raw' e discos adicionais para 'qcow2', verificando a integridade de cada uma. (testar com uma VM, se ocorrer tudo bem, prosseguir com as demais).Comando: qemu-img convert -f vhdx -O raw NomeDoVHD.extensão nomeDoNovoVHDConvertido.raw
 
 Checar integridade: qemu-img check NomeDoVHD.extensão

Relacionar na planilha/Jira (ou seu software de controle) os vHDs que apresentarem inconsistência.
	
Refazer vHDs que apresentaram inconsistência.
	
Criar novas VMs no Proxmox/KVM e utilizar.
  
Iniciar e verificar se o desempenho está satisfatório.
  
Verificar ativação da VM após 5min de conecta-la à internet.

Criar backup completo de cada VM certificada como ok.
